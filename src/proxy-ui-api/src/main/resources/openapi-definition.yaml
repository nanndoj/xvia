---
openapi: 3.0.0
servers:
  - description: X-Road API Design
    url: https://virtserver.swaggerhub.com/Gofore/X-Road/1.0.0
info:
  description: X-Road UI Based API
  version: "1.0.27"
  title: X-Road UI Based API
  contact:
    name: Nordic Institute for Interoperability Solutions (NIIS)
    url: https://github.com/nordic-institute/X-Road-development/#enhancement-requests-and-error-reports
    email: info@niis.org
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
tags:
  - name: security server
    description: <br>Security Server API design
  - name: central server
    description: <br>Central Server API design
paths:
  /backups:
    get: # ok
      tags:
        - security server
      summary: get security server backups
      operationId: getBackups
      description: Administrator views the backups for the security server.
      responses:
        '200':
          description: list of security server backups
          content:
            application/json:
              schema:
                type: array
                description: array of backup objects
                uniqueItems: true
                items:
                  $ref: '#/components/schemas/Backup'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    post: # ok
      tags:
        - security server
      summary: add new backup for the security server
      operationId: addBackup
      description: Adds security server backup to the system
      responses:
        '201':
          description: item created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Backup'
        '202':
          description: item accepted
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /backups/upload:
    post: # ok
      tags:
        - security server
      summary: upload new backup for the security server
      operationId: uploadBackup
      description: Uploads new security server backup to the system
      parameters:
        - in: query
          name: ignore_warnings
          description: if true, any ignorable warnings are ignored. if false (or missing),
                    any warnings cause request to fail
          required: false
          schema:
            type: boolean
            default: false
      requestBody:
        description: backup to add
        content:
          multipart/form-data:
            schema:
              title: BackupArchive
              type: object
              description: security server backup archive file
              properties:
                file:
                  type: string
                  format: binary
      responses:
        '201':
          description: item created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Backup'
        '202':
          description: item accepted
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /backups/{filename}:
    delete: # ok
      tags:
        - security server
      summary: delete security server backup
      operationId: deleteBackup
      description: Administrator deletes the backup of the security server.
      parameters:
        - in: path
          name: filename
          description: filename of the backup
          required: true
          schema:
            type: string
            format: filename
            minLength: 1
            maxLength: 255
      responses:
        '204':
          description: deletion was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '500':
          description: internal server error
  /backups/{filename}/restore:
    put: # ok
      tags:
        - security server
      summary: restore security server configuration from backup
      operationId: restoreBackup
      description: Administrator restores the security server configuration from backup.
      parameters:
        - in: path
          name: filename
          description: filename of the backup
          required: true
          schema:
            type: string
            format: filename
            minLength: 1
            maxLength: 255
      responses:
        '200':
          description: restore was successful
          content:
            application/json:
              schema:
                description: response that tells if hsm tokens were logged out during the restore process
                title: TokensLoggedOut
                type: object
                properties:
                  hsm_tokens_logged_out:
                    description: whether any hsm tokens were logged out during the restore process
                    type: boolean
                    default: false
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /backups/{filename}/download:
    get: # ok
      tags:
        - security server
      summary: download security server backup
      operationId: downloadBackup
      description: Administrator downloads the backup of the security server.
      parameters:
        - in: path
          name: filename
          description: filename of the backup
          required: true
          schema:
            type: string
            format: filename
            minLength: 1
            maxLength: 255
      responses:
        '200':
          description: backup file downloaded
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
                description: backup file
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /token-certificates:
    post: # ok
      tags:
        - security server
      summary: import new certificate
      operationId: importCertificate
      description: Imports certificate to the system
      requestBody:
        description: certificate to import
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: certificate file
      responses:
        '201':
          description: certificate created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenCertificate'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /token-certificates/{hash}:
    get: # ok
      tags:
        - security server
      summary: get certificate information
      operationId: getCertificate
      description: Administrator views certificate details.
      parameters:
        - in: path
          name: hash
          description: SHA-1 hash of the certificate
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '200':
          description: token certificate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenCertificate'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    delete: # ok
      tags:
        - security server
      summary: delete certificate
      operationId: deleteCertificate
      description: Administrator deletes the certificate.
      parameters:
        - in: path
          name: hash
          description: SHA-1 hash of the certificate
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '204':
          description: deletion was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '500':
          description: internal server error
  /token-certificates/{hash}/activate:
    put: # ok
      tags:
        - security server
      summary: activate certificate
      operationId: activateCertificate
      description: Administrator activates selected certificate.
      parameters:
        - in: path
          name: hash
          description: SHA-1 hash of the certificate
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '204':
          description: request was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /token-certificates/{hash}/disable:
    put: # ok
      tags:
        - security server
      summary: deactivate certificate
      operationId: disableCertificate
      description: Administrator deactivates selected certificate.
      parameters:
        - in: path
          name: hash
          description: SHA-1 hash of the certificate
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '204':
          description: certificate was deactivated
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /token-certificates/{hash}/import:
    post: # ok
      tags:
        - security server
      summary: import an existing certificate from a token by cert hash
      operationId: importCertificateFromToken
      description: Imports certificate from a token to the system
      parameters:
        - in: path
          name: hash
          description: SHA-1 hash of the certificate
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '201':
          description: the imported certificate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenCertificate'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /token-certificates/{hash}/possible-actions:
    get: # ok
      tags:
        - security server
      summary: get possible actions for one certificate
      operationId: getPossibleActionsForCertificate
      description: UI needs to know which actions can be done on one certificate
      parameters:
        - in: path
          name: hash
          description: SHA-1 hash of the certificate
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '200':
          description: possible actions that can be done on the certificate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PossibleActions'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /token-certificates/{hash}/register:
    put: # ok
      tags:
        - security server
      summary: register certificate
      operationId: registerCertificate
      description: Administrator registers selected certificate.
      parameters:
        - in: path
          name: hash
          description: SHA-1 hash of the certificate
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      requestBody:
        content:
          application/json:
            schema:
              title: SecurityServerAddress
              type: object
              required:
                - address
              properties:
                address:
                  type: string
                  description: Security server's IP address or DNS name
                  format: text
                  minLength: 1
                  maxLength: 255
              example:
                address: 127.0.0.1
      responses:
        '200':
          description: request was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /token-certificates/{hash}/unregister:
    put: # ok
      tags:
        - security server
      summary: unregister authentication certificate
      operationId: unregisterAuthCertificate
      description: Administrator unregisters selected authentication certificate.
      parameters:
        - in: path
          name: hash
          description: SHA-1 hash of the certificate
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '204':
          description: request was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /token-certificates/{hash}/mark-for-deletion:
    put: # ok
      tags:
        - security server
      summary: marks an auth certificate for deletion
      operationId: markAuthCertForDeletion
      description: Administrator marks an auth certificate for deletion.
      parameters:
        - in: path
          name: hash
          description: SHA-1 hash of the certificate
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '204':
          description: request was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /clients:
    get: # ok
      tags:
        - security server
      summary: find security server clients
      operationId: findClients
      description: Administrator views the clients of the security server.
      parameters:
        - in: query
          name: name
          description: pass an optional search string (name) for looking up clients
          required: false
          schema:
            type: string
            format: text
            minLength: 0
            maxLength: 255
        - in: query
          name: instance
          description: pass an optional search string (instance) for looking up clients
          required: false
          schema:
            type: string
            format: text
            minLength: 0
            maxLength: 255
        - in: query
          name: member_class
          description: pass an optional search string (member_class) for looking up clients
          required: false
          schema:
            type: string
            format: text
            minLength: 0
            maxLength: 255
        - in: query
          name: member_code
          description: pass an optional search string (member_code) for looking up clients
          required: false
          schema:
            type: string
            format: text
            minLength: 0
            maxLength: 255
        - in: query
          name: subsystem_code
          description: pass an optional search string (subsystem_code) for looking up clients
          required: false
          schema:
            type: string
            format: text
            minLength: 0
            maxLength: 255
        - in: query
          name: show_members
          description: to include members for search results
          required: false
          schema:
            type: boolean
            default: true
        - in: query
          name: internal_search
          description: to search only clients inside security server
          required: false
          schema:
            type: boolean
            default: true
        - in: query
          name: local_valid_sign_cert
          description: to search only local clients with valid sign cert
          required: false
          schema:
            type: boolean
            default: false
        - in: query
          name: exclude_local
          description: to search only clients that are not added to this security server
          required: false
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: list of clients
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of client objects
                items:
                  $ref: '#/components/schemas/Client'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    post: # ok
      tags:
        - security server
      summary: Add new client for the security server.
      operationId: addClient
      description: >
        Adds new client to the system.
        Note that with this endpoint it is possible to add an unregistered member as a client.
        Attempt to add an unregistered member with ClientAdd.ignore_warnings = false causes the operation to fail with a warning in response's ErrorInfo object.
        Attempt to add an unregistered member with ClientAdd.ignore_warnings = true succeeds.
      requestBody:
        description: client to add
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ClientAdd'
      responses:
        '201':
          description: new client created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Client'
        '400':
          description: there are warnings or errors related to the service description
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                items:
                  $ref: '#/components/schemas/ErrorInfo'
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /clients/{id}:
    get: # ok
      tags:
        - security server
      summary: get security server client information
      operationId: getClient
      description: Administrator views the client details of the security server.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '200':
          description: client object
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Client'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    patch: # ok
      tags:
        - security server
      summary: update security server client information
      operationId: updateClient
      description: Administrator updates the client information.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      requestBody:
        content:
          application/json:
            schema:
              title: ConnectionTypeWrapper
              type: object
              description: connection type
              properties:
                connection_type:
                  $ref: '#/components/schemas/ConnectionType'
      responses:
        '200':
          description: client modified
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Client'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    delete: # ok
      tags:
        - security server
      summary: delete security server client
      operationId: deleteClient
      description: Administrator deletes the client of the security server.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '204':
          description: client deletion was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '500':
          description: internal server error
  /clients/{id}/local-groups:
    get: # ok
      tags:
        - security server
      summary: get local groups for the selected client
      operationId: getClientLocalGroups
      description: Administrator views the local groups for the client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '200':
          description: list of local groups
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of local group objects
                items:
                  $ref: '#/components/schemas/LocalGroup'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    post: # ok
      tags:
        - security server
      summary: add new local group for the security server client
      operationId: addClientLocalGroup
      description: Administrator adds a new local group for the client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      requestBody:
        description: group to add
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LocalGroupAdd'
      responses:
        '201':
          description: local group created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocalGroup'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /clients/{id}/orphans:
    get: # ok
      tags:
        - security server
      summary: get information about orphaned sign keys, certificates and csrs left behind a delete client
      operationId: getClientOrphans
      description: Administrator has deleted a client and wants to know if some orphaned sign keys, certificates or csrs exist
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '200':
          description: information telling that orphans exist. If they don't exist, 404 is returned instead.
          content:
            application/json:
              schema:
                title: OrphanInformation
                type: object
                properties:
                  orphans_exist:
                    type: boolean
                    default: false
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    delete: # ok
      tags:
        - security server
      summary: delete orphaned sign keys, certificates and csrs left behind a delete client
      operationId: deleteOrphans
      description: Administrator deletes the orphaned sign keys, certificates and csrs left behind a delete client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '204':
          description: deletion was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '500':
          description: internal server error
  /clients/{id}/register:
    put: # ok
      tags:
        - security server
      summary: register security server client
      operationId: registerClient
      description: Administrator registers client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '204':
          description: client was registered
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /clients/{id}/service-clients:
    get: # ok
      tags:
        - security server
      summary: get service clients for the selected client's services
      operationId: getClientServiceClients
      description: Administrator views the service clients for the client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '200':
          description: list of service clients
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of service client objects
                items:
                  $ref: '#/components/schemas/ServiceClient'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /clients/{id}/service-clients/{sc_id}:
    get: # ok
      tags:
        - security server
      summary: get single service client by client id and service client id
      operationId: getServiceClient
      description: Administrator views the information for a single service client
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
        - in: path
          name: sc_id
          description: id of the service client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '200':
          description: single service clients
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceClient'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /clients/{id}/service-clients/{sc_id}/access-rights:
    get: # ok
      tags:
        - security server
      summary: get access rights for the selected service client.
      operationId: getServiceClientAccessRights
      description: Administrator views service client's access rights.
      parameters:
        - in: path
          name: id
          description: id of the client who owns the services
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
        - in: path
          name: sc_id
          description: id of the service client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1279
      responses:
        '200':
          description: list of access rights
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of access right objects
                items:
                  $ref: '#/components/schemas/AccessRight'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    post: # ok
      tags:
        - security server
      summary: add new access rights for selected service client. If service client did not exist yet, one is created.
      operationId: addServiceClientAccessRights
      description: Adds access rights to the service client.
      parameters:
        - in: path
          name: id
          description: id of the client who owns the services
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
        - in: path
          name: sc_id
          description: id of the service client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1279
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AccessRights'
      responses:
        '201':
          description: access right that was added
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of added access right objects
                items:
                  $ref: '#/components/schemas/AccessRight'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /clients/{id}/service-clients/{sc_id}/access-rights/delete:
    post: # ok
      tags:
        - security server
      summary: remove access rights
      operationId: deleteServiceClientAccessRights
      description: Administrator removes access rights from selected service client.
      parameters:
        - in: path
          name: id
          description: id of the client who owns the services
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
        - in: path
          name: sc_id
          description: id of the service client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1279
      requestBody:
        description: list of access rights to be deleted
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AccessRights'
      responses:
        '204':
          description: access right(s) deleted
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /clients/{id}/sign-certificates:
    get: # ok
      tags:
        - security server
      summary: get security server client certificates information
      operationId: getClientSignCertificates
      description: Administrator views the certificates for the client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '200':
          description: list of certificates
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of certificate (details) objects
                items:
                  $ref: '#/components/schemas/TokenCertificate'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /clients/{id}/tls-certificates:
    get: # ok
      tags:
        - security server
      summary: get security server client TLS certificates information
      operationId: getClientTlsCertificates
      description: Administrator views the TLS certificates for the client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '200':
          description: list of tls certificates
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of certificate (details) objects
                items:
                  $ref: '#/components/schemas/CertificateDetails'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    post: # ok
      tags:
        - security server
      summary: add new certificate for the security server client
      operationId: addClientTlsCertificate
      description: Administrator adds a new certificate for the client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      requestBody:
        description: certificate to add
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: certificate file
      responses:
        '201':
          description: certificate added
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CertificateDetails'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /clients/{id}/tls-certificates/{hash}:
    get: # ok
      tags:
        - security server
      summary: get TLS certificate
      operationId: getClientTlsCertificate
      description: Administrator gets the TLS certificate for the selected client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
        - in: path
          name: hash
          description: SHA-1 hash of the certificate
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '200':
          description: certificate details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CertificateDetails'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    delete: # ok
      tags:
        - security server
      summary: delete certificate
      operationId: deleteClientTlsCertificate
      description: Administrator deletes the certificate from selected client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
        - in: path
          name: hash
          description: SHA-1 hash of the certificate
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '204':
          description: certificate deletion was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '500':
          description: internal server error
  /clients/{id}/unregister:
    put: # ok
      tags:
        - security server
      summary: unregister security server client
      operationId: unregisterClient
      description: Administrator unregisters client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '204':
          description: unregister was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /clients/{id}/service-descriptions:
    get: # ok
      tags:
        - security server
      summary: get security server client service descriptions
      operationId: getClientServiceDescriptions
      description: Administrator views the service descriptions for the client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      responses:
        '200':
          description: list of service descriptions
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of service description objects
                items:
                  $ref: '#/components/schemas/ServiceDescription'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    post: # ok
      tags:
        - security server
      summary: add new service description for the security server client
      operationId: addClientServiceDescription
      description: Administrator adds a new service description for the client.
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceDescriptionAdd'
      responses:
        '201':
          description: service description created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceDescription'
        '400':
          description: there are warnings or errors related to the service description
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                items:
                  $ref: '#/components/schemas/ErrorInfo'
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /clients/{id}/service-client-candidates:
    get: # ok
      tags:
        - security server
      summary: find ServiceClient candidates for a specific client
      operationId: findServiceClientCandidates
      description: Administrator views the clients, globalgroups and localgroups, that could be added as ServiceClients for given Client's services
      parameters:
        - in: path
          name: id
          description: id of the client
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
        - in: query
          name: member_name_group_description
          description: pass an optional search string (name) for looking up subjects - name of a member or description of a group
          example: NIIS | Some group description
          required: false
          schema:
            type: string
            format: text
            minLength: 0
            maxLength: 255
        - in: query
          name: service_client_type
          description: pass an optional search string (service_client_type) for looking up service clients
          required: false
          schema:
            $ref: '#/components/schemas/ServiceClientType'
        - in: query
          name: instance
          description: pass an optional search string (instance) for looking up service clients - full instance id should be used
          example: GOV
          required: false
          schema:
            type: string
            format: text
            minLength: 0
            maxLength: 255
        - in: query
          name: member_class
          description: pass an optional search string (member_class) for looking up service clients
          required: false
          schema:
            type: string
            format: text
            minLength: 0
            maxLength: 255
        - in: query
          name: member_group_code
          description: pass an optional search string (member_group_code) for looking up service clients - member_code of a member or group_code of a group
          example: 1234 | Example group code
          required: false
          schema:
            type: string
            format: text
            minLength: 0
            maxLength: 255
        - in: query
          name: subsystem_code
          description: pass an optional search string (subsystem_code) for looking up service clients
          example: Subsystem1
          required: false
          schema:
            type: string
            format: text
            minLength: 0
            maxLength: 255
      responses:
        '200':
          description: list of service clients
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of ServiceClients
                items:
                  $ref: '#/components/schemas/ServiceClient'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /clients/owner:
    put: # ok
      tags:
        - security server
      summary: make client Security Server's owner. Client must be a member and already registered on the Security Server
      operationId: changeOwner
      description: Administrator changes Security Server's owner.
      requestBody:
        description: client to be set as owner
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Client'
      responses:
        '204':
          description: client was set as owner
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /diagnostics/globalconf:
    get: # ok
      tags:
        - security server
      summary: view global configuration diagnostics information
      operationId: getGlobalConfDiagnostics
      description: Administrator views the global configuration diagnostics information.
      responses:
        '200':
          description: global configuration diagnostics information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GlobalConfDiagnostics'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /diagnostics/ocsp-responders:
    get: # ok
      tags:
        - security server
      summary: view ocsp responders diagnostics information
      operationId: getOcspRespondersDiagnostics
      description: Administrator views the ocsp responders diagnostics information.
      responses:
        '200':
          description: ocsp responders diagnostics information
          content:
            application/json:
              schema:
                type: array
                description: array of ocsp responder diagnostics objects
                uniqueItems: true
                items:
                  $ref: '#/components/schemas/OcspResponderDiagnostics'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /diagnostics/timestamping-services:
    get: # ok
      tags:
        - security server
      summary: view timestamping services diagnostics information
      operationId: getTimestampingServicesDiagnostics
      description: Administrator views the timestamping services diagnostics information.
      responses:
        '200':
          description: timestamping services diagnostics information
          content:
            application/json:
              schema:
                type: array
                description: array of timestamping service diagnostics objects
                uniqueItems: true
                items:
                  $ref: '#/components/schemas/TimestampingServiceDiagnostics'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /initialization:
    post: # ok
      tags:
        - security server
      summary: Initialize a new security server with the provided initial configuration
      operationId: initSecurityServer
      description: Administrator initializes a new security server with the provided initial configuration
      requestBody:
        description: initial security server configuration
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InitialServerConf'
      responses:
        '201':
          description: security server initialized
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /initialization/status:
    get: # ok
      tags:
        - security server
      summary: Check the initialization status of the Security Server
      operationId: getInitializationStatus
      description: Administrator checks the initialization status of the Security Server
      responses:
        '200':
          description: initialization status of the Security Server
          content:
            application/json:
              schema:
                type: object
                title: InitializationStatus
                description: Initialization status of the Security Server
                properties:
                  is_anchor_imported:
                    type: boolean
                    description: whether a configuration anchor has been imported or not
                  is_server_code_initialized:
                    type: boolean
                    description: whether the server code of the security server has been initialized or not
                  is_server_owner_initialized:
                    type: boolean
                    description: whether the server owner of the security server has been initialized or not
                  is_software_token_initialized:
                    type: boolean
                    description: whether a software token has been initialized or not
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /local-groups/{group_id}:
    get: # ok
      tags:
        - security server
      summary: get local group information
      operationId: getLocalGroup
      description: Administrator views local group details.
      parameters:
        - in: path
          name: group_id
          description: id of the local group
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '200':
          description: group object
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocalGroup'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    patch: # ok
      tags:
        - security server
      summary: update local group information
      operationId: updateLocalGroup
      description: Administrator updates the local group information.
      parameters:
        - in: path
          name: group_id
          description: id of the local group
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              title: LocalGroupDescription
              type: object
              required:
                - description
              properties:
                description:
                  type: string
                  description: description for the LocalGroup
                  format: text
                  minLength: 1
                  maxLength: 255
              example:
                name: This is an awesome local group!
      responses:
        '200':
          description: local group modified
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LocalGroup'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    delete: # ok
      tags:
        - security server
      summary: delete local group
      operationId: deleteLocalGroup
      description: Administrator deletes the local group.
      parameters:
        - in: path
          name: group_id
          description: id of the local group
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '204':
          description: local group deletion was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '500':
          description: internal server error
  /local-groups/{group_id}/members:
    post: # ok
      tags:
        - security server
      summary: add new member for the local group
      operationId: addLocalGroupMember
      description: Administrator adds a new member for the local group. The new member can be an X-Road member or a subsystem
      parameters:
        - in: path
          name: group_id
          description: id of the local group
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Members'
      responses:
        '201':
          description: new members added
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Members'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /local-groups/{group_id}/members/delete:
    post: # ok
      tags:
        - security server
      summary: delete member from local group
      operationId: deleteLocalGroupMember
      description: Administrator deletes the member from local group.
      parameters:
        - in: path
          name: group_id
          description: id of the local group
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Members'
      responses:
        '204':
          description: members deleted
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /keys/{id}:
    get: # ok
      tags:
        - security server
      summary: get information for the selected key in selected token
      operationId: getKey
      description: Administrator views key details.
      parameters:
        - in: path
          name: id
          description: id of the key
          required: true
          schema:
            type: string
            format: text
            minLength: 1
      responses:
        '200':
          description: key object
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Key'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    patch: # ok
      tags:
        - security server
      summary: update key information
      operationId: updateKey
      description: Administrator updates the key information.
      parameters:
        - in: path
          name: id
          description: id of the key
          required: true
          schema:
            type: string
            format: text
            minLength: 1
      requestBody:
        content:
          application/json:
            schema:
              title: KeyName
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: Friendly name of a key
                  format: text
                  minLength: 1
                  maxLength: 255
              example:
                name: my-key-0
      responses:
        '200':
          description: key modified
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Key'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    delete: # ok
      tags:
        - security server
      summary: delete key
      operationId: deleteKey
      description: Administrator deletes the key.
      parameters:
        - in: path
          name: id
          description: id of the key
          required: true
          schema:
            type: string
            format: text
            minLength: 1
      responses:
        '204':
          description: key deletion was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '500':
          description: internal server error
  /keys/{id}/csrs:
    post: # ok
      tags:
        - security server
      summary: generate csr for the selected key
      operationId: generateCsr
      description: Administrator generates csr for the key.
      parameters:
        - in: path
          name: id
          description: id of the key
          required: true
          schema:
            type: string
            format: text
            minLength: 1
      requestBody:
        description: request to generate csr
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CsrGenerate'
      responses:
        '201':
          description: created CSR
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
                description: csr file
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /keys/{id}/csrs/{csr_id}:
    get: # ok
      tags:
        - security server
      summary: download a CSR binary
      operationId: downloadCsr
      description: Administrator downloads a csr that has been created earlier
      parameters:
        - in: path
          name: id
          description: id of the key
          required: true
          schema:
            type: string
            format: text
            minLength: 1
        - in: path
          name: csr_id
          description: id of the csr
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
        - in: query
          name: csr_format
          description: format of the certificate signing request (PEM or DER)
          required: false
          schema:
            $ref: '#/components/schemas/CsrFormat'
      responses:
        '201':
          description: CSR binary
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
                description: csr file
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    delete: # ok
      tags:
        - security server
      summary: delete csr from the selected key
      operationId: deleteCsr
      description: Administrator deletes csr from the key.
      parameters:
        - in: path
          name: id
          description: id of the key
          required: true
          schema:
            type: string
            format: text
            minLength: 1
        - in: path
          name: csr_id
          description: id of the csr
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '204':
          description: csr deletion was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /keys/{id}/csrs/{csr_id}/possible-actions:
    get: # ok
      tags:
        - security server
      summary: get possible actions for one csr
      operationId: getPossibleActionsForCsr
      description: UI needs to know which actions can be done on one csr
      parameters:
        - in: path
          name: id
          description: id of the key
          required: true
          schema:
            type: string
            format: text
            minLength: 1
        - in: path
          name: csr_id
          description: id of the csr
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 40
      responses:
        '200':
          description: possible actions that can be done on the certificate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PossibleActions'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /keys/{id}/possible-actions:
    get: # ok
      tags:
        - security server
      summary: get possible actions for one key
      operationId: getPossibleActionsForKey
      description: UI needs to know which actions can be done on one key
      parameters:
        - in: path
          name: id
          description: id of the key
          required: true
          schema:
            type: string
            format: text
            minLength: 1
      responses:
        '200':
          description: possible actions that can be done on the certificate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PossibleActions'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /member-classes:
    get: # ok
      tags:
        - security server
      summary: get list of known member classes
      operationId: getMemberClasses
      description: Administrator lists member classes.
      parameters:
        - in: query
          name: current_instance
          description: if true, return member classes for this instance.
            if false (default), return member classes for all instances
          required: false
          schema:
            default: false
            type: boolean
      responses:
        '200':
          description: array of member classes
          content:
            application/json:
              schema:
                type: array
                description: array of member classes
                uniqueItems: true
                items:
                  type: string
                  format: text
                  minLength: 1
                  maxLength: 255
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /member-classes/{id}:
    get: # ok
      tags:
        - security server
      summary: get list of known member classes for a given instance
      operationId: getMemberClassesForInstance
      description: Administrator lists member classes for a given instance.
      parameters:
        - in: path
          name: id
          description: instance id
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '200':
          description: array of member classes
          content:
            application/json:
              schema:
                type: array
                description: array of member classes
                uniqueItems: true
                items:
                  type: string
                  format: text
                  minLength: 1
                  maxLength: 255
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /member-names:
    get: # ok
      tags:
        - security server
      summary: find member name by member class and member code
      operationId: findMemberName
      description: Administrator looks up member's name
      parameters:
        - in: query
          name: member_class
          description: class of the member
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
        - in: query
          name: member_code
          description: code of the member
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '200':
          description: name of the member
          content:
            application/json:
              schema:
                title: MemberName
                type: object
                description: member's name
                properties:
                  member_name:
                    type: string
                    format: text
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /language:
    put: # ok
      tags:
        - security server
      summary: change language
      operationId: language
      description: Administrator changes the language for the UI.
      parameters:
        - in: path
          name: code
          description: code of the language (language code)
          required: true
          schema:
            type: string
            format: text
            minLength: 2
            maxLength: 2
      responses:
        '200':
          description: language changed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Language'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /user:
    get: # ok
      tags:
        - security server
      summary: get user data for the logged user
      operationId: getUser
      description: Administrator gets user data from backend.
      responses:
        '200':
          description: user details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /security-servers:
    get: # ok
      tags:
        - security server
      summary: get all security servers
      operationId: getSecurityServers
      description: SS administrator views the details of all security servers
      parameters:
        - in: query
          name: current_server
          description: whether to only get the current server's identifier
          required: false
          schema:
            default: false
            type: boolean
      responses:
        '200':
          description: list of SecurityServer objects
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of SecurityServer objects
                items:
                  $ref: '#/components/schemas/SecurityServer'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /security-servers/{id}:
    get: # ok
      tags:
        - security server
      summary: get security server information
      operationId: getSecurityServer
      description: SS administrator views the details of a security server.
      parameters:
        - in: path
          name: id
          description: id of the security server
          required: true
          schema:
            type: string
            format: text
            description: <instance_id>:<member_class>:<member_code>:<security_server_code>
            example: FI:GOV:123:sserver1
      responses:
        '200':
          description: ok
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SecurityServer'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /services/{id}:
    get: # ok
      tags:
        - security server
      summary: get service
      operationId: getService
      description: Administrator views selected service.
      parameters:
        - in: path
          name: id
          description: id of the service
          required: true
          schema:
            type: string
            example: CS:ORG:Client:myService.v1
            format: text
            minLength: 1
            maxLength: 1535
      responses:
        '200':
          description: ok
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Service'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    patch: # ok
      tags:
        - security server
      summary: update service
      operationId: updateService
      description: Administrator updates the service.
      parameters:
        - in: path
          name: id
          description: id of the service
          required: true
          schema:
            type: string
            example: CS:ORG:Client:myService.v1
            format: text
            minLength: 1
            maxLength: 1535
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceUpdate'
      responses:
        '200':
          description: service modified
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Service'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /services/{id}/endpoints:
    post:
      tags:
        - security server
      summary: create endpoint
      operationId: addEndpoint
      description: Administrator creates a new endpoint.
      parameters:
        - in: path
          name: id
          description: id of the service
          required: true
          schema:
            type: string
            example: CS:ORG:Client:myService.v1
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Endpoint'
      responses:
        '201':
          description: endpoint added
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Endpoint'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /services/{id}/service-clients:
    get: # ok
      tags:
        - security server
      summary: get service clients who have access rights for the selected service
      operationId: getServiceServiceClients
      description: Administrator views service clients who have access to the given service
      parameters:
        - in: path
          name: id
          description: id of the service
          required: true
          schema:
            type: string
            example: CS:ORG:Client:myService.v1
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '200':
          description: list of service clients
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of service client objects
                items:
                  $ref: '#/components/schemas/ServiceClient'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    post:
      tags:
        - security server
      summary: add access rights to selected service for new ServiceClients
      operationId: addServiceServiceClients
      description: Adds access rights to selected service for new ServiceClients
      parameters:
        - in: path
          name: id
          description: id of the service
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceClients'
      responses:
        '201':
          description: access rights added
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of added service client objects
                items:
                  $ref: '#/components/schemas/ServiceClient'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /services/{id}/service-clients/delete:
    post: # ok
      tags:
        - security server
      summary: remove access to selected service from given ServiceClients
      operationId: deleteServiceServiceClients
      description: Administrator removes access to selected service from given ServiceClients
      parameters:
        - in: path
          name: id
          description: id of the service
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceClients'
      responses:
        '204':
          description: access right(s) deletion was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '500':
          description: internal server error
  /endpoints/{id}:
    get:
      tags:
        - security server
      operationId: getEndpoint
      description: Administrator fetches an endpoint
      parameters:
        - in: path
          name: id
          description: id of the endpoint
          required: true
          schema:
            type: string
            example: 102
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '200':
          description: endpoint
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Endpoint'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    put:
      tags:
        - security server
      operationId: updateEndpoint
      description: Administrator updates an endpoint
      parameters:
        - in: path
          name: id
          description: id of the endpoint
          required: true
          schema:
            type: string
            example: 102
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EndpointUpdate'
      responses:
        '200':
          description: endpoint updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Endpoint'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    delete:
      tags:
        - security server
      summary: delete endpoint
      operationId: deleteEndpoint
      description: Administrator removes an endpoint
      parameters:
        - in: path
          name: id
          required: true
          description: id of the endpoint
          schema:
            type: string
            example: 102
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '204':
          description: endpoint deleted
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /endpoints/{id}/service-clients:
    get:
      tags:
        - security server
      summary: get service clients who have access rights for the selected endpoint
      operationId: getEndpointServiceClients
      description: Administrator views endpoints access rights
      parameters:
        - in: path
          name: id
          description: id of the endpoint
          required: true
          schema:
            type: string
            format: text
            minLength: 1
      responses:
        '200':
          description: list of access rights
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of access right objects
                items:
                  $ref: '#/components/schemas/ServiceClient'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    post:
      tags:
        - security server
      summary: add access rights for given service clients to the selected endpoint
      operationId: addEndpointServiceClients
      description: Administrator add access rights for a service clients to the selected endpoint
      parameters:
        - in: path
          name: id
          description: id of the endpoint
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceClients'
      responses:
        '201':
          description: access rights added
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of added service client objects
                items:
                  $ref: '#/components/schemas/ServiceClient'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /endpoints/{id}/service-clients/delete:
    post:
      tags:
        - security server
      summary: remove access rights from specified service clients to the selected endpoint
      operationId: deleteEndpointServiceClients
      description: Administrator removes access rights from a service clients to an endpoint
      parameters:
        - in: path
          name: id
          description: id of the endpoint
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        description: Service client to be removed
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceClients'
      responses:
        '204':
          description: access right(s) deleted
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /service-descriptions/{id}:
    get: # ok
      tags:
        - security server
      summary: get service description with provided id
      operationId: getServiceDescription
      description: Administrator views a service description with a certain id.
      parameters:
        - in: path
          name: id
          description: id of the service description
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '200':
          description: wanted service description
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceDescription'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    patch: # ok
      tags:
        - security server
      summary: update url or service code for the selected service description
      operationId: updateServiceDescription
      description: Administrator updates the selected service description.
      parameters:
        - in: path
          name: id
          description: id of the service description
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceDescriptionUpdate'
      responses:
        '200':
          description: service description modified
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceDescription'
        '400':
          description: there are warnings or errors related to the service description
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                items:
                  $ref: '#/components/schemas/ErrorInfo'
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    delete: # ok
      tags:
        - security server
      summary: delete service description
      operationId: deleteServiceDescription
      description: Administrator deletes the service description.
      parameters:
        - in: path
          name: id
          description: id of the service description
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '204':
          description: service description deletion was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '500':
          description: internal server error
  /service-descriptions/{id}/disable:
    put: # ok
      tags:
        - security server
      summary: disable selected service description
      operationId: disableServiceDescription
      description: Administrator disables service description.
      parameters:
        - in: path
          name: id
          description: id of the service description
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        required: false
        content:
          application/json:
            schema:
              title: ServiceDescriptionDisabledNotice
              type: object
              properties:
                disabled_notice:
                  type: string
                  format: text
                  description: disabled service notice
                  minLength: 0
                  maxLength: 255
      responses:
        '204':
          description: service description disabled
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /service-descriptions/{id}/enable:
    put: # ok
      tags:
        - security server
      summary: enable selected service description
      operationId: enableServiceDescription
      description: Administrator enables service description.
      parameters:
        - in: path
          name: id
          description: id of the service description
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '204':
          description: service description enabled
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /service-descriptions/{id}/refresh:
    put: # ok
      tags:
        - security server
      summary: refresh selected service description
      operationId: refreshServiceDescription
      description: Administrator refreshes service description.
      parameters:
        - in: path
          name: id
          description: id of the service description
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              title: IgnoreWarnings
              type: object
              properties:
                ignore_warnings:
                  type: boolean
                  default: false
                  description: if true, any ignorable warnings are ignored. if false (or missing),
                    any warnings cause request to fail
      responses:
        '200':
          description: service description refreshed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceDescription'
        '400':
          description: there are warnings or errors related to the service description
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                items:
                  $ref: '#/components/schemas/ErrorInfo'
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /service-descriptions/{id}/services:
    get: # ok
      tags:
        - security server
      summary: get services for the selected service description
      operationId: getServiceDescriptionServices
      description: Administrator views the services for the selected service description.
      parameters:
        - in: path
          name: id
          description: id of the service description
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '200':
          description: list of services
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of service objects
                items:
                  $ref: '#/components/schemas/Service'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /system/anchor:
    get: # ok
      tags:
        - security server
      summary: view the configuration anchor information
      operationId: getAnchor
      description: Administrator views the configuration anchor information.
      responses:
        '200':
          description: anchor information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Anchor'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    post: # ok
      tags:
        - security server
      summary: Upload a new configuration anchor file when initializing a new security server.
        Calls to this endpoint only succeed if a configuration anchor is not already found – meaning that this endpoint can only be used when initializing a new security server.
        For updating the anchor for an already initialized security server use the PUT /system/anchor endpoint instead
      operationId: uploadInitialAnchor
      description: Administrator uploads a new configuration anchor file in the security server's initialization phase
      requestBody:
        description: configuration anchor
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: configuration anchor file
      responses:
        '201':
          description: configuration anchor uploaded
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
    put: # ok
      tags:
        - security server
      summary: Upload a configuration anchor file to replace an existing one. Note that this only works if there already exists an anchor that can be replaced.
        When initalizing a new Security Server use endpoint POST /system/anchor instead
      operationId: replaceAnchor
      description: Administrator uploads a configuration anchor file anytime after the Security Server has been initialized
      requestBody:
        description: configuration anchor
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: configuration anchor file
      responses:
        '201':
          description: configuration anchor uploaded
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /system/anchor/previews:
    post: # ok
      tags:
        - security server
      summary: Read and the configuration anchor file and return the hash for a preview.
        The instance of the anchor is also validated unless the validate_instance query parameter is explicitly set to false.
        The anchor will not be saved
      operationId: previewAnchor
      description: Administrator wants to preview a configuration anchor file hash
      parameters:
        - in: query
          name: validate_instance
          description: Whether or not to validate the owner instance of the anchor.
            Set this to false explicitly when previewing an anchor in the security server initialization phase.
            Default value is true if the parameter is omitted.
          required: false
          schema:
            type: boolean
            default: true
      requestBody:
        description: configuration anchor
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: configuration anchor file
      responses:
        '201':
          description: configuration anchor uploaded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Anchor'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /system/anchor/download:
    get: # ok
      tags:
        - security server
      summary: download configuration anchor information
      operationId: downloadAnchor
      description: Administrator downloads the configuration anchor information.
      responses:
        '200':
          description: configuration anchor
          content:
            application/xml:
              schema:
                type: string
                format: binary
                description: configuration anchor file
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /system/certificate:
    get: # ok
      tags:
        - security server
      summary: view the security server certificate information
      operationId: getSystemCertificate
      description: Administrator views the security server TLS certificate information.
      responses:
        '200':
          description: certificate information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CertificateDetails'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    post: # ok
      tags:
        - security server
      summary: generate a new internal TLS key and cert
      operationId: generateSystemTlsKeyAndCertificate
      description: Administrator generates new internal TLS key and certificate
      responses:
        '204':
          description: tls key generated
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /system/certificate/export:
    get: # ok
      tags:
        - security server
      summary: download the security server certificate as gzip compressed tar archive
      operationId: downloadSystemCertificate
      description: Administrator downloads the security server TLS certificate.
      responses:
        '200':
          description: information fetched successfully
          content:
            application/gzip:
              schema:
                type: string
                format: binary
                description: certificate file
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /system/certificate/csr:
    post: # ok
      tags:
        - security server
      summary: generate new certificate request
      operationId: generateSystemCertificateRequest
      description: Administrator generates new certificate request.
      requestBody:
        content:
          application/json:
            schema:
              required:
                - distinguished_name
              title: DistinguishedName
              type: object
              properties:
                name:
                  type: string
                  format: text
                  description: distinguished name
                  example: C=FI, O=X-Road Test, OU=X-Road Test CA OU, CN=X-Road Test CA CN
                  minLength: 1
                  maxLength: 255
      responses:
        '201':
          description: created CSR
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
                description: csr file
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /system/certificate/import:
    post: # ok
      tags:
        - security server
      summary: import new internal TLS certificate.
      operationId: importSystemCertificate
      description: Administrator imports new internal TLS certificate
      requestBody:
        description: certificate to add
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
              description: certificate file
      responses:
        '200':
          description: tls certificate imported
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CertificateDetails'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /certificate-authorities:
    get: # ok
      tags:
        - security server
      summary: view the approved certificate authorities
      operationId: getApprovedCertificateAuthorities
      description: Administrator views the approved certificate authorities.
      parameters:
        - in: query
          name: key_usage_type
          description: return only CAs suitable for this type of key usage
          required: false
          schema:
            $ref: '#/components/schemas/KeyUsageType'
        - in: query
          name: include_intermediate_cas
          description: if true, include also intermediate CAs. Otherwise only top CAs are included. Default value is "false".
          required: false
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: list of approved certificate authorities
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of certificate authority objects
                items:
                  $ref: '#/components/schemas/CertificateAuthority'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /certificate-authorities/{ca_name}/csr-subject-fields:
    get: # ok
      tags:
        - security server
      summary: get description of subject DN fields for CSR
      operationId: getSubjectFieldDescriptions
      description: list DN field descriptions to collect CSR parameters
      parameters:
        - in: path
          name: ca_name
          description: common name of the CA
          example: X-Road Test CA CN
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
        - in: query
          name: key_id
          description: id of the key. If provided, used only for validating correct key usage
          required: false
          schema:
            type: string
            format: text
            minLength: 1
        - in: query
          name: key_usage_type
          description: which usage type this CSR is for
          required: true
          schema:
            $ref: '#/components/schemas/KeyUsageType'
        - in: query
          name: member_id
          description: member client id for signing CSRs. <instance_id>:<member_class>:<member_code>
          example: FI:GOV:123
          required: false
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 767
      responses:
        '200':
          description: csr subject field objects
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of CsrSubjectFieldDescription objects
                items:
                  $ref: '#/components/schemas/CsrSubjectFieldDescription'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /system/timestamping-services:
    get: # ok
      tags:
        - security server
      summary: view the configured timestamping services
      operationId: getConfiguredTimestampingServices
      description: Administrator views the configured timestamping services.
      responses:
        '200':
          description: list of configured timestamping services
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of timestamping service objects
                items:
                  $ref: '#/components/schemas/TimestampingService'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    post: # ok
      tags:
        - security server
      summary: add a configured timestamping service
      operationId: addConfiguredTimestampingService
      description: Administrator selects new timestamping service
      requestBody:
        description: Timestamping service to add
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TimestampingService'
      responses:
        '201':
          description: timestamping service created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TimestampingService'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists
        '500':
          description: internal server error
  /system/timestamping-services/delete:
    post: # ok
      tags:
        - security server
      summary: delete configured timestamping service
      operationId: deleteConfiguredTimestampingService
      description: Administrator removes configured timestamping service.
      requestBody:
        description: Timestamping service to delete
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TimestampingService'
      responses:
        '204':
          description: timestamping service deletion was successful
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '500':
          description: internal server error
  /system/version:
    get: # ok
      tags:
        - security server
      summary: get information for the system version
      operationId: systemVersion
      description: Administrator views key details.
      responses:
        '200':
          description: system version information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Version'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /timestamping-services:
    get: # ok
      tags:
        - security server
      summary: view the approved timestamping services
      operationId: getApprovedTimestampingServices
      description: Administrator views the approved timestamping services.
      responses:
        '200':
          description: list of approved timestamping services
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of timestamping service objects
                items:
                  $ref: '#/components/schemas/TimestampingService'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error

  /tokens:
    get: # ok
      tags:
        - security server
      summary: get security server tokens
      operationId: getTokens
      description: Administrator views tokens of the security server.
      responses:
        '200':
          description: list of tokens
          content:
            application/json:
              schema:
                type: array
                uniqueItems: true
                description: array of token objects
                items:
                  $ref: '#/components/schemas/Token'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /tokens/{id}:
    get: # ok
      tags:
        - security server
      summary: get security server token information
      operationId: getToken
      description: Administrator views the token details of the security server.
      parameters:
        - in: path
          name: id
          description: id of the token
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      responses:
        '200':
          description: token object
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
    patch: # ok
      tags:
        - security server
      summary: update security server token information
      operationId: updateToken
      description: Administrator updates the token information.
      parameters:
        - in: path
          name: id
          description: id of the token
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              title: TokenName
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: friendly name of the token
                  format: text
                  minLength: 1
                  maxLength: 255
              example:
                name: my-token-0
      responses:
        '200':
          description: token modified
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /tokens/{id}/keys-with-csrs:
    post: # ok
      tags:
        - security server
      summary: add a new key and generate a csr for it
      operationId: addKeyAndCsr
      description: Administrator adds a new key and generates a csr for it.
      parameters:
        - in: path
          name: id
          description: id of the token
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              title: KeyLabelWithCsrGenerate
              type: object
              required:
                - csr_generate_request
              properties:
                key_label:
                  type: string
                  format: text
                  description: label for the new key
                  minLength: 1
                  maxLength: 255
                  example: My new key
                csr_generate_request:
                  $ref: '#/components/schemas/CsrGenerate'
      responses:
        '201':
          description: key created for the token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KeyWithCertificateSigningRequestId'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists or token not logged in
        '500':
          description: internal server error
  /tokens/{id}/keys:
    post: # ok
      tags:
        - security server
      summary: add new key
      operationId: addKey
      description: Adds key for selected token.
      parameters:
        - in: path
          name: id
          description: id of the token
          required: true
          schema:
            type: string
            format: text
            minLength: 1
            maxLength: 255
      requestBody:
        content:
          application/json:
            schema:
              title: KeyLabel
              type: object
              properties:
                label:
                  type: string
                  format: text
                  description: label for the new key
                  minLength: 1
                  maxLength: 255
              example:
                label: My new key
      responses:
        '201':
          description: key created for the token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Key'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '409':
          description: an existing item already exists or token not logged in
        '500':
          description: internal server error
  /tokens/{id}/login:
    put: # ok
      tags:
        - security server
      summary: login to token
      operationId: loginToken
      description: Login to token
      parameters:
        - in: path
          name: id
          description: id of the token
          required: true
          schema:
            type: string
            format: text
            minLength: 1
      requestBody:
        content:
          application/json:
            schema:
              title: TokenPassword
              type: object
              properties:
                password:
                  type: string
                  format: text
                  description: password for logging in to the token
                  minLength: 1
              example:
                password: sm3!!ycat
      responses:
        '200':
          description: logged in
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /tokens/{id}/logout:
    put: # ok
      tags:
        - security server
      summary: logout from token
      operationId: logoutToken
      description: Administrator logs out from token.
      parameters:
        - in: path
          name: id
          description: id of the token
          required: true
          schema:
            type: string
            format: text
            minLength: 1
      responses:
        '200':
          description: logged out
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
  /xroad-instances:
    get: # ok
      tags:
        - security server
      summary: get list of known xroad instance identifiers
      operationId: getXroadInstances
      description: Administrator lists xroad instance identifiers
      responses:
        '200':
          description: xroad instance identifiers
          content:
            application/json:
              schema:
                type: array
                description: array of xroad instance identifiers
                uniqueItems: true
                items:
                  type: string
                  format: text
                  minLength: 1
                  maxLength: 255
        '400':
          description: request was invalid
        '401':
          description: authentication credentials are missing
        '403':
          description: request has been refused
        '404':
          description: resource requested does not exists
        '406':
          description: request specified an invalid format
        '500':
          description: internal server error
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: Authorization
      description: X-Road-ApiKey token=<api key>
      # https://github.com/nordic-institute/X-Road-REST-UI/blob/XRDDEV-237/doc/Manuals/ug-ss_x-road_6_security_server_user_guide.md#1911-creating-new-api-keys
  schemas:
    AccessRight: # ok
      type: object
      description: access right given for a specific subject (ServiceClient) for specific service (service_code) owned by some client. This object does not represent endpoint-level access rights
      required:
        - service_code
      properties:
        service_code:
          type: string
          format: text
          description: service code
          example: clientDeletion
          minLength: 1
          maxLength: 255
        service_title:
          type: string
          readOnly: true
          format: text
          description: service title
          example: client deletion
          minLength: 1
          maxLength: 255
        rights_given_at:
          type: string
          format: date-time
          description: access right given at
          example: '2018-12-15T00:00:00.001Z'
          readOnly: true
          minLength: 24
          maxLength: 24
    AccessRights: # ok
      type: object
      description: object containing and array of AccessRights
      properties:
        items:
          type: array
          uniqueItems: true
          description: array of AccessRights
          items:
            $ref: '#/components/schemas/AccessRight'
    Anchor: # ok
      type: object
      description: security server anchor
      required:
        - hash
        - created_at
      properties:
        hash:
          type: string
          format: hash
          description: anchor hash
          example: 42:34:C3:22:55:42:34:C3:22:55:42:34:C3:22:55:42:34:C3:22:55:42:34:C3:22:55:42:34:C3
          minLength: 1
          maxLength: 255
        created_at:
          type: string
          format: date-time
          description: anchor created at
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
    Backup: # ok
      type: object
      description: security server backup
      required:
        - filename
        - created_at
      properties:
        filename:
          type: string
          format: filename
          description: backup filename
          example: configuration_backup_20181224.tar
          minLength: 1
          maxLength: 255
        created_at:
          type: string
          format: date-time
          description: backup created at
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
    TokenCertificateSigningRequest: # ok
      type: object
      description: CSR for certificate that is stored in a Token
      required:
        - id
        - owner_id
        - possible_actions
      properties:
        id:
          type: string
          format: text
          description: CSR id
          example: 0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF
          readOnly: true
        owner_id:
          type: string
          format: text
          description: client id of the owner member, <instance_id>:<member_class>:<member_code>
          example: FI:GOV:123
          minLength: 1
          maxLength: 767
          readOnly: true
        possible_actions:
          $ref: '#/components/schemas/PossibleActions'
          description: possible actions that can be done to this object, e.g DELETE.
            Has value only for operationIds getToken and getTokens.
            Does not consider user authorization.
    TokenCertificate: # ok
      type: object
      description: certificate that is stored in a Token (auth or sign cert)
      required:
        - ocsp_status
        - owner_id
        - active
        - saved_to_configuration
        - certificate_details
        - status
      properties:
        ocsp_status:
          $ref: '#/components/schemas/CertificateOcspStatus'
        owner_id:
          type: string
          format: text
          description: client id of the owner member, <instance_id>:<member_class>:<member_code>
          example: FI:GOV:123
          minLength: 1
          maxLength: 767
          readOnly: true
        active:
          type: boolean
          description: if the certificate is active
          example: true
        saved_to_configuration:
          type: boolean
          description: if the certificate is saved to configuration
          example: true
        certificate_details:
          $ref: '#/components/schemas/CertificateDetails'
        status:
          $ref: '#/components/schemas/CertificateStatus'
        possible_actions:
          $ref: '#/components/schemas/PossibleActions'
          description: possible actions that can be done to this object, e.g DELETE.
            Has value only for operationIds getToken and getTokens.
            Does not consider user authorization.
    OcspResponderDiagnostics: # ok
      type: object
      description: Ocsp responder diagnostics
      required:
        - distinguished_name
        - ocsp_responders
      properties:
        distinguished_name:
          type: string
          format: text
          description: CA distinguished name
          example: C=FI, O=X-Road Test, OU=X-Road Test CA OU, CN=X-Road Test CA CN
          minLength: 1
          maxLength: 255
          readOnly: true
        ocsp_responders:
          type: array
          readOnly: true
          items:
            $ref: '#/components/schemas/OcspResponder'
    CertificateDetails: # ok
      type: object
      description: certificate details for any kind of certificate (TLS, auth, sign)
      required:
        - issuer_distinguished_name
        - issuer_common_name
        - subject_distinguished_name
        - subject_common_name
        - not_before
        - not_after
        - serial
        - version
        - signature_algorithm
        - signature
        - public_key_algorithm
        - rsa_public_key_modulus
        - rsa_public_key_exponent
        - hash
        - key_usages
      properties:
        issuer_distinguished_name:
          type: string
          format: text
          description: certificate issuer distinguished name
          example: issuer123
          minLength: 1
          maxLength: 255
        issuer_common_name:
          type: string
          format: text
          description: certificate issuer common name
          example: domain.com
          minLength: 1
          maxLength: 255
        subject_distinguished_name:
          type: string
          format: text
          description: certificate subject distinguished name
          example: subject123
          minLength: 1
          maxLength: 255
        subject_common_name:
          type: string
          format: text
          description: certificate subject common name
          example: domain.com
          minLength: 1
          maxLength: 255
        not_before:
          type: string
          format: date-time
          description: certificate validity not before
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
        not_after:
          type: string
          format: date-time
          description: certificate validity not after
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
        serial:
          type: string
          format: text
          description: serial number
          example: '123456789'
          minLength: 1
          maxLength: 255
        version:
          type: integer
          format: int32
          example: 3
          description: version
        signature_algorithm:
          type: string
          format: sha-256
          description: certificate signature algorithm
          example: sha256WithRSAEncryption
          minLength: 1
          maxLength: 255
        signature:
          type: string
          format: text
          description: hex encoded certificate signature
          example: '30af2fdc1780...'
          minLength: 1
          maxLength: 255
        public_key_algorithm:
          type: string
          format: sha-256
          description: certificate public key algorithm
          example: 'sha256WithRSAEncryption'
          minLength: 1
          maxLength: 255
        rsa_public_key_modulus:
          type: string
          format: hex
          description: hex encoded RSA public key modulus (if RSA key)
          example: c44421d601...
          minLength: 1
          maxLength: 1000
        rsa_public_key_exponent:
          type: integer
          format: int32
          description: RSA public key exponent (if RSA key) as an integer
          example: 65537
        hash:
          type: string
          format: text
          description: certificate SHA-1 hash
          example: 1234567890ABCDEF
          minLength: 1
          maxLength: 40
        key_usages:
          type: array
          description: certificate key usage array
          uniqueItems: true
          items:
            $ref: '#/components/schemas/KeyUsage'
    CertificateAuthority: # ok
      type: object
      description: approved certificate authority information. Only for top CAs.
      required:
        - name
        - subject_distinguished_name
        - issuer_distinguished_name
        - ocsp_response
        - not_after
        - top_ca
        - path
        - authentication_only
      properties:
        name:
          type: string
          format: text
          description: name of the CA, as defined in global conf. Used also as an identifier
          example: X-Road Test CA CN
          minLength: 1
          maxLength: 255
        subject_distinguished_name:
          type: string
          format: text
          description: subject distinguished name
          example: C=FI, O=X-Road Test, OU=X-Road Test CA OU, CN=X-Road Test CA CN
          minLength: 1
          maxLength: 1024
        issuer_distinguished_name:
          type: string
          format: text
          description: issuer distinguished name
          example: C=FI, O=X-Road Test, OU=X-Road Test CA OU, CN=X-Road Test CA CN
          minLength: 1
          maxLength: 1024
        ocsp_response:
          $ref: '#/components/schemas/CertificateAuthorityOcspResponse'
        not_after:
          type: string
          format: date-time
          description: certificate authority expires at
          example: '2099-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
        top_ca:
          type: boolean
          description: if the certificate authority is top CA (instead of intermediate)
          example: true
        path:
          type: string
          format: text
          description: encoded path string from this CA to top CA
          example: C=FI, O=X-Road Test Intermediate, OU=X-Road Test CA OU, CN=X-Road Test CA CN Intermediate:C=FI, O=X-Road Test, OU=X-Road Test CA OU, CN=X-Road Test CA CN
          minLength: 1
        authentication_only:
          type: boolean
          description: if certificate authority is limited for authentication use only
    CertificateStatus: # ok
      type: string
      format: enum
      description: certificate status
      example: IN_USE
      enum:
        - SAVED
        - REGISTRATION_IN_PROGRESS
        - REGISTERED
        - DELETION_IN_PROGRESS
        - GLOBAL_ERROR
    CertificateAuthorityOcspResponse: # ok
      type: string
      format: enum
      description: certificate authority OCSP status
      example: IN_USE
      enum:
        - NOT_AVAILABLE
        - OCSP_RESPONSE_UNKNOWN
        - OCSP_RESPONSE_GOOD
        - OCSP_RESPONSE_SUSPENDED
        - OCSP_RESPONSE_REVOKED
    CertificateOcspStatus: # ok
      type: string
      format: enum
      description: certificate status
      example: IN_USE
      enum:
        - DISABLED
        - EXPIRED
        - OCSP_RESPONSE_UNKNOWN
        - OCSP_RESPONSE_GOOD
        - OCSP_RESPONSE_SUSPENDED
        - OCSP_RESPONSE_REVOKED
    PossibleActions: # ok
      type: array
      description: array containing the possible actions that can be done for this item
      items:
        $ref: '#/components/schemas/PossibleAction'
    PossibleAction: # ok
      type: string
      format: enum
      description: an action to change state or edit token, key, cert or csr
      example: DELETE
      enum:
        - DELETE
        - ACTIVATE
        - DISABLE
        - LOGIN
        - LOGOUT
        - REGISTER
        - UNREGISTER
        - IMPORT_FROM_TOKEN
        - GENERATE_KEY
        - EDIT_FRIENDLY_NAME
        - GENERATE_AUTH_CSR
        - GENERATE_SIGN_CSR
    Client: # ok
      type: object
      description: x-road client
      required:
        - member_class
        - member_code
      properties:
        id:
          type: string
          format: text
          description: <instance_id>:<member_class>:<member_code>:<subsystem>(optional)
          example: FI:GOV:123:ABC
          minLength: 1
          maxLength: 1023
          readOnly: true
        instance_id:
          type: string
          format: text
          description: xroad instance id
          example: FI
          minLength: 1
          maxLength: 255
          readOnly: true
        member_name:
          type: string
          format: text
          description: member name
          example: FI
          readOnly: true
          minLength: 1
          maxLength: 255
        member_class:
          type: string
          format: text
          description: member class
          example: GOV
          minLength: 1
          maxLength: 255
        member_code:
          type: string
          format: text
          description: member code
          example: 123
          minLength: 1
          maxLength: 255
        subsystem_code:
          type: string
          format: text
          description: subsystem code
          example: ABC
          minLength: 1
          maxLength: 255
        owner:
          type: boolean
          description: if this client is the owner member of this security server
          example: false
          readOnly: true
        has_valid_local_sign_cert:
          type: boolean
          description: if this client is local and has a valid sign cert
          example: false
          readOnly: true
        connection_type:
          $ref: '#/components/schemas/ConnectionType'
        status:
          $ref: '#/components/schemas/ClientStatus'
          readOnly: true
    ClientAdd: # ok
      type: object
      description: request to add client. Carries a Client and ignore warnings parameter
      required:
        - client
      properties:
        client:
          $ref: '#/components/schemas/Client'
        ignore_warnings:
          type: boolean
          default: false
          description: if true, any ignorable warnings are ignored. if false (or missing),
            any warnings cause request to fail
    ClientStatus: # ok
      type: string
      format: enum
      description: client status
      example: REGISTERED
      enum:
        - REGISTERED
        - SAVED
        - GLOBAL_ERROR
        - REGISTRATION_IN_PROGRESS
        - DELETION_IN_PROGRESS
    ConfigurationStatus: # ok
      type: string
      format: enum
      description: configuration status
      example: SUCCESS
      enum:
        - SUCCESS # Everything ok
        - ERROR_CODE_INTERNAL # Internal error occurred.
        - ERROR_CODE_INVALID_SIGNATURE_VALUE # Invalid signature value.
        - ERROR_CODE_EXPIRED_CONF # The downloaded global configuration has expired.
        - ERROR_CODE_CANNOT_DOWNLOAD_CONF # Unable to download global configuration. Check network connection to global configuration provider.
        - ERROR_CODE_MISSING_PRIVATE_PARAMS # The downloaded global configuration did not contain private parameters
        - ERROR_CODE_UNINITIALIZED # The configuration client is initializing.
        - UNKNOWN
    CodeWithMetadata:
      type: object
      description: object that contains a code identifier and possibly collection of
        associated metadata. Used to relay error and warning information.
      required:
        - code
      properties:
        code:
          type: string
          format: text
          description: identifier of the item (for example errorcode)
          example: adding_services
        metadata:
          type: array
          description: array containing metadata associated with the item. For example names of services
            were attempted to add, but failed
          uniqueItems: true
          items:
            type: string
            format: text
    ConnectionType: # ok
      type: string
      format: enum
      description: connection type
      example: HTTP
      default: HTTPS
      enum:
        - HTTP
        - HTTPS
        - HTTPS_NO_AUTH
    CsrFormat: # ok
      type: string
      format: enum
      description: csr format
      example: PEM
      default: PEM
      enum:
        - PEM
        - DER
    CsrGenerate:
      type: object
      description: request to generate a CSR
      required:
        - key_usage_type
        - ca_name
        - csr_format
        - subject_field_values
      properties:
        key_usage_type:
          description: which usage type this CSR is for (signing or authentication)
          $ref: '#/components/schemas/KeyUsageType'
        ca_name:
          type: string
          format: text
          description: common name of the CA
          example: X-Road Test CA CN
          minLength: 1
          maxLength: 255
        csr_format:
          description: format of the certificate signing request (PEM or DER)
          $ref: '#/components/schemas/CsrFormat'
        member_id:
          type: string
          format: text
          description: member client id for signing CSRs. <instance_id>:<member_class>:<member_code>
          example: FI:GOV:123
          minLength: 1
          maxLength: 767
        subject_field_values:
          type: object
          description: user-provided values for subject DN parameters
          additionalProperties:
            type: string
    CsrSubjectFieldDescription:
      type: object
      description: object describing input fields for CSR subject DN info
      required:
        - id
        - localized
        - read_only
        - required
      properties:
        id:
          type: string
          format: text
          description: the identifier of the field (such as 'O', 'OU' etc)
          example: O
          minLength: 1
          readOnly: true
        label:
          type: string
          format: text
          description: label of the field, used to display the field in the user interface
          example: ORGANIZATION_NAME
          minLength: 1
          readOnly: true
        label_key:
          type: string
          format: text
          description: localization key for label of the field, used to display the field in the user interface
          example: Organization name (O)
          minLength: 1
          readOnly: true
        default_value:
          type: string
          format: text
          description: the default value of the field. Can be empty.
          example: 1234
          minLength: 0
          readOnly: true
        read_only:
          type: boolean
          description: if this field is read-only
          example: true
          readOnly: true
        required:
          type: boolean
          description: if this field is required to be filled
          example: true
          readOnly: true
        localized:
          type: boolean
          description: if true, label key is in property "label_key". If false, actual label is in property "label"
          example: true
          readOnly: true
    DiagnosticStatusClass: # ok
      type: string
      format: enum
      description: diagnostics status class
      example: OK
      enum:
        - OK
        - WAITING
        - FAIL
    ErrorInfo:
      type: object
      description: object returned in error cases
      required:
        - status
      properties:
        status:
          type: integer
          format: int32
          description: http status code
          example: 400
        error:
          $ref: '#/components/schemas/CodeWithMetadata'
        warnings:
          type: array
          description: warnings that could be ignored
          uniqueItems: true
          items:
            $ref: '#/components/schemas/CodeWithMetadata'
    GlobalConfiguration: # ok
      type: object
      description: global configuration
      required:
        - status
        - updated_at
        - next_update_at
      properties:
        status:
          $ref: '#/components/schemas/ConfigurationStatus'
        updated_at:
          type: string
          format: date-time
          description: last time updated
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
        next_update_at:
          type: string
          format: date-time
          description: last time updated
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
    InitialServerConf: # ok
      type: object
      description: security server initial configuration
      properties:
        owner_member_class:
          type: string
          format: text
          description: member class
          example: GOV
          minLength: 1
          maxLength: 255
        owner_member_code:
          type: string
          format: text
          description: member code
          example: 12345678-9
          minLength: 1
          maxLength: 255
        security_server_code:
          type: string
          format: text
          description: security server code
          example: SS1
          minLength: 1
          maxLength: 255
        software_token_pin:
          type: string
          format: text
          description: pin code for the initial software token
          example: sup3rs3cr3t_p!n
          minLength: 1
          maxLength: 255
        ignore_warnings:
          type: boolean
          default: false
          description: if true, any ignorable warnings are ignored. if false (or missing),
            any warnings cause request to fail
    LocalGroup: # ok
      type: object
      description: group
      required:
        - code
        - description
      properties:
        id:
          type: string
          format: text
          description: unique identifier
          example: 123
          readOnly: true
        code:
          type: string
          format: text
          description: group code
          example: groupcode
          minLength: 1
          maxLength: 255
        description:
          type: string
          format: text
          description: group description
          example: description
          minLength: 1
          maxLength: 255
        member_count:
          type: integer
          format: uint
          description: member count
          example: 10
          minimum: 0
          maximum: 1000000
        updated_at:
          type: string
          format: date-time
          description: last time updated
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
        members:
          type: array
          description: group members
          uniqueItems: true
          items:
            $ref: '#/components/schemas/GroupMember'
    LocalGroupAdd: # ok
      type: object
      description: model for adding a new LocalGroup
      required:
        - code
        - description
      properties:
        code:
          type: string
          format: text
          description: group code
          example: groupcode
          minLength: 1
          maxLength: 255
        description:
          type: string
          format: text
          description: group description
          example: description
          minLength: 1
          maxLength: 255
    GlobalConfDiagnostics: # ok
      type: object
      description: global configuration diagnostics
      required:
        - status_class
        - status_code
        - prev_update_at
        - next_update_at
      properties:
        status_class:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/DiagnosticStatusClass'
        status_code:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/ConfigurationStatus'
        prev_update_at:
          type: string
          format: date-time
          description: last time updated
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
          readOnly: true
        next_update_at:
          type: string
          format: date-time
          description: last time updated
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
          readOnly: true
    GroupMember: # ok
      type: object
      description: group member
      required:
        - id
        - name
        - created_at
      properties:
        id:
          type: string
          format: text
          description: group member id
          example: FI:GOV:123:SS1
          minLength: 1
          maxLength: 1023
        name:
          type: string
          format: text
          description: group member name
          example: Member123
          minLength: 1
          maxLength: 255
        created_at:
          type: string
          format: date-time
          description: group member created at
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
    KeyWithCertificateSigningRequestId: # ok
      type: object
      description: Key and TokenCertificateSigningRequest id
      required:
        - key
        - csr_id
      properties:
        key:
          $ref: '#/components/schemas/Key'
        csr_id:
          type: string
          format: text
          description: CSR id
          example: 0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF
    Key: # ok
      type: object
      description: key for the certificate
      required:
        - id
        - name
        - label
        - certificates
        - certificate_signing_requests
        - usage
      properties:
        id:
          type: string
          format: text
          description: key id
          example: 0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF
          minLength: 1
          readOnly: true
        name:
          type: string
          format: text
          description: key name
          example: friendly name
          minLength: 1
          maxLength: 255
        label:
          type: string
          format: text
          description: key label
          example: key label
          minLength: 1
          maxLength: 255
        certificates:
          type: array
          description: list of certificates for the key
          items:
            $ref: '#/components/schemas/TokenCertificate'
        certificate_signing_requests:
          type: array
          description: list of CSRs for the key
          items:
            $ref: '#/components/schemas/TokenCertificateSigningRequest'
        usage:
          $ref: '#/components/schemas/KeyUsageType'
        available:
          type: boolean
          description: if the key is available
          example: true
        saved_to_configuration:
          type: boolean
          description: if the key is saved to configuration
          example: true
        possible_actions:
          $ref: '#/components/schemas/PossibleActions'
          description: possible actions that can be done to this object, e.g DELETE.
            Has value only for operationIds getToken and getTokens.
            Does not consider user authorization.
    KeyUsage: # ok
      type: string
      format: enum
      description: certificate key usage
      example: NON_REPUDIATION
      enum:
        - DIGITAL_SIGNATURE
        - NON_REPUDIATION
        - KEY_ENCIPHERMENT
        - DATA_ENCIPHERMENT
        - KEY_AGREEMENT
        - KEY_CERT_SIGN
        - CRL_SIGN
        - ENCIPHER_ONLY
        - DECIPHER_ONLY
    KeyUsageType: # ok
      type: string
      format: enum
      description: intended usage for the key
      example: AUTHENTICATION
      enum:
        - AUTHENTICATION
        - SIGNING
    KeyValuePair: # ok
      type: object
      description: key-value pair of strings
      required:
        - key
        - value
      properties:
        key:
          type: string
          description: key
        value:
          type: string
          description: value
    Language: # ok
      type: object
      description: language
      required:
        - id
      properties:
        id:
          type: string
          format: text
          description: language code
          example: en
          minLength: 2
          maxLength: 2
          readOnly: true
    Members: # ok
      type: object
      description: Request object containing an array of member ids. The id must be an X-Road member id or subsystem id
      properties:
        items:
          type: array
          description: array of members to be added
          example: ["FI:GOV:123", "FI:GOV:123:SS1", "FI:GOV:123:SS2"]
          items:
            type: string
            format: text
            minLength: 1
            maxLength: 1023
    OcspResponder: # ok
      type: object
      description: OCSP responder diagnostics
      required:
        - url
        - status_class
        - status_code
        - next_update_at
      properties:
        url:
          type: string
          format: url
          description: url of the OCSP responder
          example: http://dev.xroad.rocks:123
          minLength: 1
          maxLength: 255
          readOnly: true
        status_class:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/DiagnosticStatusClass'
        status_code:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/OcspStatus'
        prev_update_at:
          type: string
          format: date-time
          description: last time updated
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
          readOnly: true
        next_update_at:
          type: string
          format: date-time
          description: next time updated
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
          readOnly: true
    OcspStatus: # ok
      type: string
      format: enum
      description: OCSP responder status
      example: SUCCESS
      enum:
        - SUCCESS # Everything ok
        - ERROR_CODE_OCSP_CONNECTION_ERROR # Unable to connect to the OCSP responder.
        - ERROR_CODE_OCSP_FAILED # Unable to fetch response from the OCSP responder.
        - ERROR_CODE_OCSP_RESPONSE_INVALID # Unable to parse the OCSP response.
        - ERROR_CODE_OCSP_UNINITIALIZED # Status request not sent yet.
        - UNKNOWN
    SecurityServer: # ok
      type: object
      description: security server information
      required:
        - id
      properties:
        id:
          type: string
          format: text
          description: <instance_id>:<member_class>:<member_code>:<security_server_code>
          example: FI:GOV:123:sserver1
        instance_id:
          type: string
          format: text
          description: xroad instance id
          example: FI
          minLength: 1
          maxLength: 255
        member_class:
          type: string
          format: text
          description: member class
          example: GOV
          minLength: 1
          maxLength: 255
        member_code:
          type: string
          format: text
          description: member code
          example: 123
          minLength: 1
          maxLength: 255
        server_code:
          type: string
          format: text
          description: security server code
          example: server123
          minLength: 1
          maxLength: 255
        server_address:
          type: string
          format: text
          description: security server address (ip or name)
          example: 192.168.1.100
          maxLength: 255
    Service: # ok
      type: object
      description: service for the service description
      required:
        - id
        - service_code
        - url
        - timeout
      properties:
        id:
          type: string
          format: text
          description: encoded service id, including client id
          example: CS:ORG:Client:myService.v1
          minLength: 1
          maxLength: 1535
        full_service_code:
          type: string
          format: text
          description: encoded service code and version
          example: myService.v1
          minLength: 1
          maxLength: 511
        service_code:
          type: string
          format: text
          description: encoded service code and version
          example: myService
          minLength: 1
          maxLength: 511
        timeout:
          type: integer
          format: uint
          description: service time out value
          example: 60
          minimum: 0
          maximum: 1000
        title:
          type: string
          readOnly: true
          format: text
          description: service title
          example: client deletion
          minLength: 1
          maxLength: 255
        ssl_auth:
          type: boolean
          description: service ssl auth
          example: true
        subjects_count:
          type: integer
          format: uint
          description: count of acl subjects
          example: 5
          minimum: 0
          maximum: 100000
        url:
          type: string
          format: url
          description: service url
          example: https://domain.com/service
          minLength: 1
          maxLength: 255
        endpoints:
          type: array
          description: list of endpoints linked to this service
          items:
            $ref: '#/components/schemas/Endpoint'
    ServiceUpdate: # ok
      type: object
      description: object for updating a service or all services within service description
      required:
        - service
      properties:
        service:
          $ref: '#/components/schemas/Service'
        url_all:
          description: url is applied for all services
          type: boolean
          example: false
          default: false
        timeout_all:
          description: timeout value is applied for all services
          type: boolean
          example: false
          default: false
        ssl_auth_all:
          description: ssl authentication is applied for all services
          type: boolean
          example: false
          default: false
    Endpoint:
      type: object
      description: Endpoint for a service
      required:
        - service_code
        - method
        - path
      properties:
        id:
          type: string
          description: unique identifier
          example: 15
        service_code:
          type: string
          example: example_service_code
        method:
          type: string
          description: http method mapped to this endpoint
          example: 'GET'
          enum: [ '*', 'GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'HEAD', 'OPTIONS', 'TRACE' ]
        path:
          type: string
          description: relative path where this endpoint is mapped to
          example: '/foo'
        generated:
          type: boolean
          description: has endpoint been generated from openapi3 description
          example: true
          readOnly: true
    EndpointUpdate:
      type: object
      description: Object for updating endpoints method and/or path
      properties:
        method:
          type: string
          description: http method mapped to this endpoint
          example: 'GET'
          enum: [ '*', 'GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'HEAD', 'OPTIONS', 'TRACE' ]
        path:
          type: string
          description: relative path where this endpoint is mapped to
          example: '/foo'
    ServiceClient: # ok
      type: object
      description: service client. May be a subsystem, local group, or a global group
      required:
        - id
      properties:
        id:
          type: string
          format: text
          description: subject id - can be a subsystem id <instance_id>:<member_class>:<member_code>:<subsystem> | globalgroup id <instance_id>:<group_code> | localgroup resource id in number format <id>
          example: DEV:ORG:1234:Subsystem | DEV:security-server-owners | 123
          minLength: 1
          maxLength: 1279
        name:
          type: string
          format: text
          description: name of the ServiceClient - can be the name of a member or the description of a group
          example: Security server owners
          readOnly: true
          minLength: 1
          maxLength: 255
        local_group_code:
          type: string
          format: text
          description: group code in case the object is a local group
          example: My own Local group code
          minLength: 1
          maxLength: 255
          readOnly: true
        service_client_type:
          $ref: '#/components/schemas/ServiceClientType'
          readOnly: true
        rights_given_at:
          type: string
          format: date-time
          description: time when access right were given at. When listing client's service clients without specifying the service, the time when first service access right was given to this service client for any service. When listing service clients for a specific service, time when service client was added permission to that service.
          example: '2018-12-15T00:00:00.001Z'
          readOnly: true
          minLength: 24
          maxLength: 24
    ServiceClients: # ok
      type: object
      description: object containing and array of ServiceClients
      properties:
        items:
          type: array
          uniqueItems: true
          description: array of ServiceClients
          items:
            $ref: '#/components/schemas/ServiceClient'
    ServiceDescription: # ok
      type: object
      description: WSDL/OPENAPI3/REST service
      required:
        - id
        - url
        - type
        - disabled
        - disabled_notice
        - refreshed_at
        - services
        - client_id
      properties:
        id:
          type: string
          description: unique identifier
          example: 123
        url:
          type: string
          format: url
          description: service url
          example: http://dev.xroad.rocks/services.wsdl
          minLength: 1
          maxLength: 255
        type:
          $ref: '#/components/schemas/ServiceType'
        disabled:
          type: boolean
          description: service disabled
          example: true
        disabled_notice:
          type: string
          format: text
          description: disabled notice
          example: default_disabled_service_notice
          minLength: 0
          maxLength: 255
        refreshed_at:
          type: string
          format: date-time
          description: time for service refresh
          example: "2018-12-15T00:00:00.001Z"
          minLength: 24
          maxLength: 24
        services:
          type: array
          description: service description services
          uniqueItems: true
          items:
            $ref: '#/components/schemas/Service'
        client_id:
          type: string
          format: text
          description: <instance_id>:<member_class>:<member_code>:<subsystem>(optional)
          example: FI:GOV:123:ABC
          minLength: 1
          maxLength: 255
    ServiceDescriptionAdd:
      type: object
      description: request object containing service description url, service code and type
      required:
        - url
        - type
      properties:
        url:
          type: string
          format: text
          description: path for the service description file
          example: https://domain.com/service
          minLength: 1
          maxLength: 255
        rest_service_code:
          type: string
          format: text
          description: service code for REST service
          example: exampleServiceCode
          minLength: 1
          maxLength: 255
        ignore_warnings:
          type: boolean
          description: if true, any ignorable warnings are ignored. if false (or missing),
            any warnings cause request to fail
          default: false
        type:
          $ref: '#/components/schemas/ServiceType'
    ServiceDescriptionUpdate:
      type: object
      description: request object for updating a service description url or service code
      required:
        - type
        - url
      properties:
        url:
          type: string
          format: text
          description: path for the service description file
          example: https://domain.com/service
          minLength: 1
          maxLength: 255
        rest_service_code:
          type: string
          format: text
          description: service code for REST service
          example: exampleServiceCode
          minLength: 1
          maxLength: 255
        new_rest_service_code:
          type: string
          format: test
          description: new service code for REST service
          example: newExampleServiceCode
          minLength: 1
          maxLength: 255
        ignore_warnings:
          type: boolean
          description: if true, any ignorable warnings are ignored. if false (or missing),
            any warnings cause request to fail
          default: false
        type:
          $ref: '#/components/schemas/ServiceType'
    ServiceType: # ok
      type: string
      format: text
      description: service type
      example: WSDL
      enum:
        - WSDL
        - REST
        - OPENAPI3
    ServiceClientType: # ok
      type: string
      format: text
      description: subject type
      example: GLOBALGROUP
      enum:
        - GLOBALGROUP
        - LOCALGROUP
        - SUBSYSTEM
    TimestampingService: # ok
      type: object
      description: timestamping services
      required:
        - name
        - url
      properties:
        name:
          type: string
          format: text
          description: name of the time stamping service
          example: X-Road Test TSA CN
          minLength: 1
          maxLength: 255
        url:
          type: string
          format: url
          description: url of the time stamping service
          example: http://dev.xroad.rocks:123
          minLength: 1
          maxLength: 255
    TimestampingServiceDiagnostics: # ok
      type: object
      description: timestamping service diagnostics
      required:
        - url
        - status_class
        - status_code
        - prev_update_at
      properties:
        url:
          type: string
          format: url
          description: url of the time stamping service
          example: http://dev.xroad.rocks:123
          minLength: 1
          maxLength: 255
          readOnly: true
        status_class:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/DiagnosticStatusClass'
        status_code:
          readOnly: true
          allOf:
            - $ref: '#/components/schemas/TimestampingStatus'
        prev_update_at:
          type: string
          format: date-time
          description: last time updated
          example: '2018-12-15T00:00:00.001Z'
          minLength: 24
          maxLength: 24
          readOnly: true
    TimestampingStatus: # ok
      type: string
      format: enum
      description: timestamping status
      example: SUCCESS
      enum:
        - SUCCESS # Everything ok
        - ERROR_CODE_TIMESTAMP_REQUEST_TIMED_OUT # Connection to the timestamp server timed out. Check the network connection to the timestamp server.
        - ERROR_CODE_MALFORMED_TIMESTAMP_SERVER_URL # Malformed timestamp server URL. Check the URL.
        - ERROR_CODE_TIMESTAMP_UNINITIALIZED # Connection ok, no timestamp request made yet.
        - ERROR_CODE_INTERNAL # Internal error occurred.
        - UNKNOWN
    Token: # ok
      type: object
      description: token
      required:
        - id
        - name
        - type
        - keys
        - status
        - logged_in
        - available
        - saved_to_configuration
        - read_only
      properties:
        id:
          type: string
          format: text
          description: token id
          example: 0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF
          minLength: 1
          readOnly: true
        name:
          type: string
          format: text
          description: token name
          example: softToken-0
          minLength: 1
          maxLength: 255
        type:
          $ref: '#/components/schemas/TokenType'
        keys:
          type: array
          description: token keys
          uniqueItems: true
          items:
            $ref: '#/components/schemas/Key'
        status:
          $ref: '#/components/schemas/TokenStatus'
        logged_in:
          type: boolean
          description: if the token has been logged in to
          example: true
        available:
          type: boolean
          description: if the token is available
          example: true
        saved_to_configuration:
          type: boolean
          description: if the token is saved to configuration
          example: true
        read_only:
          type: boolean
          description: if the token is read-only
          example: true
        serial_number:
          type: string
          format: text
          description: serial number of the token
          example: 12345
        token_infos:
          type: array
          description: Contains label-value pairs of information
          items:
            $ref: '#/components/schemas/KeyValuePair'
        possible_actions:
          $ref: '#/components/schemas/PossibleActions'
          description: possible actions that can be done to this object, e.g DELETE.
            Has value only for operationIds getToken and getTokens.
            Does not consider user authorization.
    TokenStatus: # ok
      type: string
      format: text
      description: token type
      example: OK
      enum:
        - OK # Normal operation status
        - USER_PIN_LOCKED # Blocked
        - USER_PIN_INCORRECT # Incorrect PIN was entered
        - USER_PIN_INVALID # Invalid PIN
        - USER_PIN_EXPIRED # PIN expired
        - USER_PIN_COUNT_LOW # Only a few tries left
        - USER_PIN_FINAL_TRY # Final try
        - NOT_INITIALIZED # Not inited
    TokenType: # ok
      type: string
      format: text
      description: token type
      example: SOFTWARE
      enum:
        - SOFTWARE
        - HARDWARE
    User: # ok
      type: object
      description: x-road user
      required:
        - username
        - roles
        - permissions
      properties:
        username:
          type: string
          format: text
          description: user username
          example: Guest
          minLength: 1
          maxLength: 255
        roles:
          type: array
          description: user roles
          uniqueItems: true
          items:
            type: string
            format: text
        permissions:
          type: array
          description: user permissions
          uniqueItems: true
          items:
            type: string
            format: text
    Version: # ok
      type: object
      description: version information
      required:
        - info
      properties:
        info:
          type: string
          format: text
          description: information about the security server
          example: Security Server version 6.21.0-SNAPSHOT-20190411git32add470
          minLength: 1
          maxLength: 255
security:
  - ApiKeyAuth: []
